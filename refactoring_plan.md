리팩토링 계획을 다시 살펴봤을 때, 전체적인 방향은 매우 적절합니다. 다만 현재 문제점(패키지 간 의존성, 타입 재사용 어려움)을 좀 더 명확히 반영하고 순서를 최적화해볼 수 있을 것 같습니다. 개선된 리팩토링 계획을 제안해 드리겠습니다:

## 개선된 리팩토링 계획

### 1. 공통 도메인 모델 패키지 생성 (첫 단계로)
- `internal/domain` 패키지 생성
- 여러 패키지에서 공유되는 핵심 데이터 타입(캔들, 시그널, 주문 등) 정의
- 기존 패키지의 중복 타입들을 이 공통 모델로 대체

### 2. 핵심 인터페이스 정의
- **교환소(Exchange) 인터페이스**: 시장 데이터 조회 및 거래 기능
- **지표(Indicator) 인터페이스**: 기술적 지표 계산
- **전략(Strategy) 인터페이스**: 시그널 감지 및 매매 결정
- **포지션 관리(PositionManager) 인터페이스**: 포지션 진입/청산/관리

### 3. 기존 구현체들을 인터페이스 뒤로 추상화
- 바이낸스 클라이언트 → Exchange 인터페이스 구현체로 변환
- 현재 MACD/SAR/EMA 전략 → Strategy 인터페이스 구현체로 변환
- 현재 포지션 관리 로직 → PositionManager 구현체로 변환

### 4. 의존성 주입 구조 구축
- 핵심 컴포넌트들이 인터페이스에만 의존하도록 변경
- 애플리케이션 시작점에서 실제 구현체 조립(wiring)
- 설정에 따라 다른 구현체로 쉽게 교체 가능하도록 구성

### 5. 패키지 구조 개선
```
internal/
├── domain/        - 공통 도메인 모델
├── exchange/      - 거래소 인터페이스와 구현체
│   ├── binance/   - 바이낸스 구현
│   └── mock/      - 테스트용 모의 거래소
├── indicator/     - 기술적 지표 인터페이스와 구현체
├── strategy/      - 트레이딩 전략 인터페이스와 구현체
│   ├── macdsarema/ - 현재 MACD/SAR/EMA 전략
│   └── custom/    - 추가 전략들
├── position/      - 포지션 관리 인터페이스와 구현체
├── config/        - 설정 관리 (인터페이스 기반으로 개선)
├── notification/  - 알림 시스템 (인터페이스 기반으로 개선)
└── app/           - 애플리케이션 시작점 및 의존성 주입
```

### 6. 단계별 구현 계획
1. 공통 도메인 모델 정의 (가장 먼저, 다른 단계의 기반)
2. 각 컴포넌트의 인터페이스 정의
3. 기존 코드를 인터페이스 구현체로 리팩토링 (점진적으로)
4. 새로운 패키지 구조로 코드 이동
5. 의존성 주입 적용
6. 테스트 추가 및 기능 검증

이 계획은 기존 계획의 주요 아이디어를 유지하면서, 타입 재사용 문제를 더 명확히 해결하고 구현 단계를 실용적으로 재정렬했습니다. 특히 공통 도메인 모델을 가장 먼저 만들어 다른 모든 단계의 기반으로 삼는 것이 중요합니다.